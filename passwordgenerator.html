<meta name=description content="Simple password generator consisting of non-repeating lowercase characters.">
<link rel=icon href=/images/keys.ico>
<link rel=stylesheet href=resources/site.css>
<link rel=stylesheet href=https://fonts.googleapis.com/css?family=Roboto>
<title>Password Generator</title>
<style>
body {
  position: relative;
}
button, input {
  font: 16px sans-serif;
}
button {
  cursor: pointer;
}
button:disabled {
  background-color: #ed4337 !important;
}
button:focus, input:focus {
  outline: none;
}
input::-webkit-inner-spin-button {  
  display: none;
}
#generate:not(:disabled):hover {
  background-color: #4095c6 !important;
}
</style>
<div style="left: 50%; position: absolute; top: 50%; transform: translate(-50%,-50%)">
  <main class=center style="padding: 65 0">
    <input id=number type=number value=1 min=1 max=26 required style="margin-right: 10; padding-bottom: 6; padding-top: 7; text-align: center; width: 44">
    <button id=generate style="background-color: #4eb5f1; border: none; border-radius: 20px; color: white; line-height: 25px; padding: 5 20; transition-duration: 0.2s">Generate</button>
    <div class=break style=margin-top:25></div>
    <input id=result value=Result readonly style="margin-right: 8; padding-bottom: 10; padding-top: 10; text-align: center; width: 238">
    <button id=copy style="background-color: white; border: 1px solid #aaa; padding: 11 10">Copy</button>
  </main>
</div>
<script>
const alphabet = "abcdefghijklmnopqrstuvwxyz",
      generate = document.getElementById("generate");

document.getElementById("number").addEventListener("input", function() {
  generate.disabled = (this.validity.valid ? false : true);
});

generate.addEventListener("click", function() {
  const length = document.querySelector("input").value,
        buffer_len = length-1;
  var buffer = "",
      charset = alphabet;
  for (let i = 0; i < buffer_len; i++) {
    while (true) {
      let pos = Math.floor(Math.random() * charset.length),
          strNewTmp = charset.substring(pos, pos+1),
          tmp = buffer.indexOf(strNewTmp);
      if (tmp == -1) {
        buffer += strNewTmp;
        break;
      }
      else
        charset = charset.replace(strNewTmp, "");
    }
  }
  charset = alphabet;
  while (true) {
    let pos = Math.floor(Math.random() * charset.length),
        new_tmp = charset.substring(pos, pos+1),
        tmp = buffer.indexOf(new_tmp);
    if (tmp == -1) {
      const insert_pos = Math.floor(Math.random() * buffer_len);
      var result = buffer.substring(0, insert_pos) + new_tmp + buffer.substring(insert_pos, buffer_len);
      break;
    }
    else
      charset = charset.replace(new_tmp, "");
  }
  document.getElementById("result").value = result;
});

document.getElementById("copy").addEventListener("click", function() {
  navigator.clipboard.writeText(document.getElementById("result").value);
});
</script>